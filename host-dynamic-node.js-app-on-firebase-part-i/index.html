<!doctype html>
<html prefix="og: http://ogp.me/ns#" lang="en">
  <head itemscope itemtype="https://theyashwantsoni.github.io">
    <meta charset="utf-8" /> 
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="generator" content="Hugo 0.71.0" />
    
    <link rel="stylesheet" href="https://theyashwantsoni.github.io/css/custom.css">
    
    <link rel="stylesheet" href="https://theyashwantsoni.github.io/css/github.css">
    
    
    
    <title>Host dynamic Node.js app on Firebase: Part-I | codeporn</title>
    <link href="https://fonts.googleapis.com/css?family=Ubuntu:400,300,600" rel="stylesheet" type="text/css">

  </head>
  <body>
    <nav class="nav-menu card">
  <div>
    <a href="https://theyashwantsoni.github.io/" style="font-size: 28px;font-weight: 600;">codeporn</a >
    
  </div>
  <ul>
     
      
      
      <li><a class="nav-link" href="https://theyashwantsoni.github.io/tags/"><i data-feather="tag"></i> Tags</a></li>
     
      
      
      <li><a class="nav-link" href="https://theyashwantsoni.github.io/"><i data-feather="home"></i> Posts</a></li>
    
  </ul>
</nav>

      <main id="main">
       
<div class="container_" style="margin-top: 50px;">
    <h1>Host dynamic Node.js app on Firebase: Part-I</h1>
    <img style="width: 100%;" src="https://theyashwantsoni.github.io/img/banner/social.png">
    
  
  
    <a href="https://theyashwantsoni.github.io/tags/firebase" class="category">Firebase</a>
  
  
    <a href="https://theyashwantsoni.github.io/tags/cloud-functions" class="category">Cloud-functions</a>
  
 <br>  

<span  class="date-time" style="color:lightgrey; font-size: 14px;">Last updated: <time datetime="2020-03-31">Mar 31, 2020</time></span>
    <div style="height: 60px;"></div>
    <article class="markdown-body">
        <p>In this tutorial, we&rsquo;ll host our dynamic Node.js app on Firebase.</p>
<p>You have probably heard of firebase static hosting, It allows you to host and serve static content.But if we want to our content to be dynamic then it can be done using firebase cloud functions and firstore realtime database.</p>
<p><strong>Dependencies</strong>:</p>
<ol>
<li>Node.js v8.0 or above</li>
</ol>
<h1 id="lets-start-building-our-app">Lets start building our app.</h1>
<h2 id="1install-firebase-cli">1)Install firebase cli</h2>
<p>Enter following command in your terminal.</p>
<pre><code>npm install -g firebase-tools
</code></pre>
<h2 id="2init-a-firebase-project">2)Init a firebase project</h2>
<pre><code>firebase init
</code></pre>
<p>It will open a banner like this. Select hosting and functions using spacebar and hit enter.</p>
<p><img src="https://raw.githubusercontent.com/theyashwantsoni/public/master/Screenshot%20from%202020-03-31%2015-02-44.png" alt=""></p>
<p>Now it will ask a series of questions which are as follows:</p>
<ul>
<li>Create a new project or use existing.</li>
<li>What language would you like to use to write Cloud Functions? JavaScript.</li>
<li>Do you want to use ESLint to catch probable bugs and enforce style? (y/N) N</li>
<li>Do you want to install dependencies with npm now? (Y/n) Y</li>
<li>What do you want to use as your public directory? (public) // by default it will use public</li>
<li>Configure as a single-page app (rewrite all urls to /index.html)? (y/N) N</li>
</ul>
<p>Check if project is configured correctly using,</p>
<pre><code>firebase serve
</code></pre>
<p>Go to localhost:5000, it will look like below snap.</p>
<p><img src="https://raw.githubusercontent.com/theyashwantsoni/public/master/Screenshot%20from%202020-03-31%2015-08-45.png" alt=""></p>
<h2 id="3project-structure">3)Project structure</h2>
<ul>
<li>A public directory - For all the static content.</li>
<li>A functions directory - For all the dynamic methods.</li>
</ul>
<p><img src="https://raw.githubusercontent.com/theyashwantsoni/public/master/Screenshot%20from%202020-03-31%2015-14-27.png" alt=""></p>
<h2 id="4create-a-basic-node-app">4)Create a basic node app</h2>
<p>Now, cd into the fucntion directory and install express framework using below command in terminal.</p>
<pre><code>npm i express --save
</code></pre>
<p>Copy and paste following code in your index.js</p>
<pre><code>const functions = require('firebase-functions');


const express = require('express');


const app = express();


app.get('/hello',(req,res)=&gt;{
    res.send(&quot;Hello from firebase&quot;);
})


exports.app = functions.https.onRequest(app);
</code></pre>
<p>Express is a minimal and flexible Node.js web application framework.</p>
<p>Here we are using express to create an app and pass it as a callback in onRequest method.</p>
<p>To check the &ldquo;hello route&rdquo;</p>
<pre><code>firebase serve
</code></pre>
<p>and go to localhost:5000/hello</p>
<p>Now, do the following changes to firebase.json.</p>
<p>Luckily it allows us rewrite to route in a hosting project</p>
<pre><code>{
  &quot;hosting&quot;: {
    &quot;public&quot;: &quot;public&quot;,
    &quot;ignore&quot;: [
      &quot;firebase.json&quot;,
      &quot;**/.*&quot;,
      &quot;**/node_modules/**&quot;
    ],
    &quot;rewrites&quot;:[{
      &quot;source&quot;:&quot;**&quot;,
      &quot;function&quot; :&quot;app&quot;
    }]
  }
}
</code></pre>
<p>Here, &ldquo;source&rdquo;:&quot;**&rdquo; will match to all routes entered.</p>
<h2 id="5creating-server-templete">5)Creating server templete</h2>
<p>Create a directory named &ldquo;views&rdquo; in our functions directory.</p>
<p>All of our templetes will go inside views.</p>
<p><img src="https://raw.githubusercontent.com/theyashwantsoni/public/master/Screenshot%20from%202020-03-31%2015-38-43.png" alt=""></p>
<p>Create a file index.hbs in views directory.</p>
<p><img src="https://raw.githubusercontent.com/theyashwantsoni/public/master/Screenshot%20from%202020-03-31%2015-39-30.png" alt=""></p>
<p>Copy and paste the following code in index.hbs.</p>
<pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset='utf-8'&gt;
    &lt;meta http-equiv='X-UA-Compatible' content='IE=edge'&gt;
    &lt;title&gt;Firebase Function Tut&lt;/title&gt;
    &lt;meta name='viewport' content='width=device-width, initial-scale=1'&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;Firebase Function Tut&lt;/h1&gt;
    &lt;ul&gt;
        {{#each data}}
        &lt;li&gt;{{name}}&lt;/li&gt;
        {{/each}}
    &lt;/ul&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>.hbs extention is used for handlebars templates. Handlebars is a simple templating language. It uses a template and an input object to generate HTML or other text formats.</p>
<h2 id="6install-handlebars-dependencies-in-project">6)Install handlebars dependencies in project.</h2>
<pre><code>cd function
npm i --save handlebars consolidate
</code></pre>
<h2 id="7use-template-engine-in-the-app">7)Use template engine in the app</h2>
<p>Copy and paste following code in index.js file.</p>
<pre><code>const functions = require('firebase-functions');
const express = require('express');
const app = express();
const engines = require('consolidate');


var dummy = [
    {name:&quot;foo&quot;},
    {name:&quot;bar&quot;}
]
app.engine('hbs',engines.handlebars);
//use handlebars template engine


app.set('views','./views');
//path to templates


app.set('view engine','hbs');


app.get('/',(req,res)=&gt;{
    res.render('index',{data : dummy});
})
//for the index route

exports.app = functions.https.onRequest(app);
</code></pre>
<p>Delete index.html file from public directory. because firebase hosting will first serve index file from public directory.It automatically serve a static file over a dynamic route.</p>
<p>Now go to localhost:5000</p>
<p><img src="https://raw.githubusercontent.com/theyashwantsoni/public/master/Screenshot%20from%202020-03-31%2016-06-03.png" alt=""></p>
<p>Fetching dynamic content from firestore will be continued in Part-II.</p>
<p>Thank you :)</p>

    </article>
</div>

      </main>
    <div class="container_">
      <hr><br>
  <p style="text-align: center;">Copyright Â© 2020 - Yashwant Soni</p>
    </div>
  </body>
</html>